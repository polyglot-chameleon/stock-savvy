generator client {
  provider        = "prisma-client"
  output          = "../generated/prisma"
  previewFeatures = ["fullTextSearchPostgres"]
}

datasource db {
  provider = "postgresql"
}

model Company {
  id          Int          @id @default(autoincrement())
  name        String
  ticker      String       @unique
  ipoDate     DateTime?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  shareValues ShareValue[]
  metrics     Metric[]
  newsItems   NewsItem[]
  ratings     Rating[]
}

model Metric {
  id        Int      @id @default(autoincrement())
  companyId Int
  date      DateTime
  eps       Float?
  per       Float?
  roe       Float?
  d2e       Float?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  company Company @relation(fields: [companyId], references: [id])

  @@index([companyId, date])
}

model ShareValue {
  id         Int      @id @default(autoincrement())
  companyId  Int
  date       DateTime
  openPrice  Float
  closePrice Float
  highPrice  Float
  lowPrice   Float
  volume     Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  company Company @relation(fields: [companyId], references: [id])

  @@index([companyId, date])
}

model NewsItem {
  id        Int       @id @default(autoincrement())
  companyId Int
  date      DateTime
  title     String
  src       String
  sentiment Sentiment
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  company Company @relation(fields: [companyId], references: [id])

  @@index([companyId, date])
}

enum Sentiment {
  POSITIVE
  NEUTRAL
  NEGATIVE
}

model Rating {
  id        Int      @id @default(autoincrement())
  companyId Int
  date      DateTime
  agency    String
  rating    Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  company Company @relation(fields: [companyId], references: [id])

  @@index([companyId, date])
}
